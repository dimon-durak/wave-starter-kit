<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">

<link rel="import" href="wave-apps.html">

<dom-module id="wave-shell">
  <template>
    <style>
      :host {
        display: block;
        width: 100vw;
        height: 100vh;
      }
    </style>

    <app-location route="{{route}}"></app-location>

    <app-route
        route="{{route}}"
        pattern="/:app"
        data="{{routeData}}"
        tail="{{subroute}}">
    </app-route>

    <!--<wave-shell-toolbar> Надо сделать </wave-shell-toolbar>-->

    <iron-pages id="apps"
        selected="[[app]]"
        attr-for-selected="app-name"
        fallback-selection="404"
        role="main">
      <wave-404-app  route="{{subroute}}"></wave-404-app>
      <wave-auth-app route="{{subroute}}"></wave-auth-app>
    </iron-pages>

    <paper-toast id="toast" duration="5555"></paper-toast>

  </template>
  <script>
    'use strict';

    class WaveShell extends Polymer.Element {

      static get is() { return 'wave-shell'}

      static get config() {
        return {
          properties: {
            app:   { type: String },
            route: { type: Object }
          },
          observers: [
            '_appChanged(routeData.app)'
          ]

        }
      }

      constructor() {
        super();
        this._app = '';
      }

      connectedCallback() {
        super.connectedCallback();
      }


      _appChanged(app) {
        this.app = app || '404'
      }

      showToast(message) {
        this.$.toast.text = message;
        this.$.toast.show();
      }
    /* 
      get app() {
        return this._app;
      } 

      set app(val) {
        this._app = val;
        this.setAttribute('app', val);
        this.dispatchEvent(new CustomEvent('app-changed', {detail: { app: val }, bubbles: false}));
      }

      _onAppChanged(e) {
        console.dir(e);
        // console.log(this.route.path);
        // this.set('this.route.path', `/${val}`);
        // console.log(this.route.path);
      }

    */

    }

    customElements.define(WaveShell.is, WaveShell);

  </script>
</dom-module>